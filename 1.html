<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #back_ground {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url(https://img.freepik.com/premium-vector/mountain-landscape-with-night-sky-illustration_105940-365.jpg?size=626&ext=jpg&ga=GA1.1.1880011253.1698969600&semt=ais);
            background-size: 100%;
        }

        #user_window {
            width: 50%;
            height: 65%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0px 2px 30px white;
            background-color: rgba(0, 0, 0, 0.205);
            backdrop-filter: blur(25px);
            border: solid 0.5px white;
            border-radius: 5px;
            color: white;
        }

        #quiz_window {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            flex-flow: column;
            
        }

        #question_part {
            width: 100%;
            max-height: 30%;
            padding: 25px 0px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: auto;
        }

        #awnser_part {
            width: 100%;
            height: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #question_navigate {
            width: 100%;
            height: 30%;
            display: flex;
            justify-content: center;
            justify-self: flex-end;
            align-items: center;
            gap: 0px 5px;
            /* border: solid 1px red; */
        }
        
        .question_navigate_buttons{
            display: flex;
            justify-content: center;
            align-items: center;
            width: 20%;
            height: 30%;
            background-color: rgba(255, 255, 255, 0.24);
            border: solid 0.5px white;
            border-radius: 1px;
            /* border: solid 1px red; */
        }
        .question_navigate_buttons:hover{
            background-color: rgba(0, 0, 0, 0.349);

        }

        #question_text {
            width: 85%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #awnser_list {
            width: 85%;
            height: 80%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-flow: column;
            gap: 5%;
        }

        #awnser_list>* {
            width: 100%;
            height: 25%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.25s ease;
            border-radius: 5px;
        }

        #awnser_list>*>* {
            margin-left: 10px;
        }

        #awnser_list>*:hover {
            color: black;
            background-color: rgb(234, 234, 234) !important;
        }

        #back_button {
            visibility: hidden;
        }

        #finish_button {
            display: none;
        }

        .question_awnser{
            border: solid 0.1px white;
        }
    </style>
</head>

<body>
    <div id="back_ground">
        <div id="user_window">
            <div id="quiz_window">
                <div id="question_part">
                    <div id="question_text">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Illum maiores
                        harum, dolorum alias quisquam repellat, vitae nostrum adipisci error ratione, dicta magni dolor
                        commodi molestiae libero qui vel eaque dolore!</div>
                </div>
                <div id="awnser_part">
                    <div id="awnser_list">
                        <div class="question_awnser" onclick="awnsering(this)">
                            <input type="radio" name="awnser_mark">
                            <div class="awnser_text"></div>
                        </div>
                        <div class="question_awnser" onclick="awnsering(this)">
                            <input type="radio" name="awnser_mark">
                            <div class="awnser_text"></div>
                        </div>
                        <div class="question_awnser" onclick="awnsering(this)">
                            <input type="radio" name="awnser_mark">
                            <div class="awnser_text"></div>
                        </div>
                        <div class="question_awnser" onclick="awnsering(this)">
                            <input type="radio" name="awnser_mark">
                            <div class="awnser_text"></div>
                        </div>
                    </div>
                </div>
                <div id="question_navigate">
                    <div class="question_navigate_buttons" onclick="question_navigate(this)" id="back_button">Back</div>
                    <div class="question_navigate_buttons" onclick="question_navigate(this)" id="next_button">Next</div>
                    <div class="question_navigate_buttons" onclick="question_navigate(this)" id="finish_button">Finish
                    </div>
                </div>
            </div>
            <div id="points_window"></div>
        </div>
    </div>
    <script>
        var question_awnser = document.getElementsByClassName("question_awnser")
        var question_navigate_buttons = document.getElementsByClassName("question_navigate_buttons")
        var question_text = document.getElementById("question_text")
        var questions_list = [
            { text: 0, awnser: [{ correct: 1, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 },] },
            { text: 1, awnser: [{ correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 },] },
            { text: 2, awnser: [{ correct: 1, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 },] },
            { text: 3, awnser: [{ correct: 1, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 },] },
            { text: 4, awnser: [{ correct: 1, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 }, { correct: 0, awnser_text: 0 },] },
        ]
        var question_number = Number.parseInt(Math.random() * questions_list.length)
        var questions_listed = []
        var questions_marked = []
        var awnser_score = [0, 0, 0, 0, 0]
        var user_score = 0
        function awnsering(element) {
            for (var i = 0; i <= question_awnser.length - 1; i++) {
                question_awnser[i].style.backgroundColor = "transparent"
                question_awnser[i].style.color = "white"
                question_awnser[i].children[0].checked = false
            }
            element.style.backgroundColor = "rgb(234, 234, 234)"
            element.style.color = "black"
            element.children[0].checked = true
        }
        function generate_question(mark_question, question_marked) {
            question_text.innerHTML = questions_list[question_number].text
            question_text.dataset.question_number = question_number
            for (var i = 0; i <= question_awnser.length - 1; i++) {
                question_awnser[i].style.backgroundColor = "transparent"
                question_awnser[i].dataset.correct = questions_list[question_number].awnser[i].correct
                question_awnser[i].children[0].checked = false
                question_awnser[i].children[1].innerHTML = questions_list[question_number].awnser[i].awnser_text
            }
            //console.log(questions_listed);
            if (!mark_question) {
                if (question_marked !== false) {
                    question_awnser[question_marked].children[0].checked = true
                    question_awnser[question_marked].style.backgroundColor = "rgb(234, 234, 234)"
                }
            } else {
                questions_listed.push(question_number)
            }
        }
        generate_question(true, false)
        function question_navigate(element) {
            var question_selected = Number(question_text.dataset.question_number)
            var question_location = questions_listed.indexOf(question_selected)
            var question_marked = false
            for (var i = 0; i <= question_awnser.length - 1; i++) {
                if (question_awnser[i].children[0].checked == true) {
                    question_marked = i
                }
            }
            if (question_marked !== false) {
                if (question_awnser[question_marked].dataset.correct == 1) {
                    awnser_score[question_location] = 1
                }
            }
            if (element.id == "next_button") {
                if (question_location == 0) {
                    question_navigate_buttons[0].style.visibility = "visible"
                } else if (question_location == 3) {
                    question_navigate_buttons[1].style.display = "none"
                    question_navigate_buttons[2].style.display = "flex"
                }
                if (question_location == questions_listed.length - 1) {
                    question_number = Number.parseInt(Math.random() * questions_list.length)
                    while (questions_listed.some(function (value) { if (value == question_number) { return true } })) {
                        question_number = Number.parseInt(Math.random() * questions_list.length)
                    }
                    questions_marked.push(question_marked)
                    generate_question(true, false)
                } else {
                    questions_marked[question_location] = question_marked
                    question_number = questions_listed[question_location + 1]
                    generate_question(false, questions_marked[question_location + 1])
                }
            } else if (element.id == "back_button") {
                if (question_location == 1) {
                    question_navigate_buttons[0].style.visibility = "hidden"
                } else if (question_location == 4) {
                    question_navigate_buttons[1].style.display = "flex"
                    question_navigate_buttons[2].style.display = "none"
                }
                if (question_location == questions_listed.length - 1 && question_location > questions_marked.length - 1) {
                    questions_marked.push(question_marked)
                } else {
                    questions_marked[question_location] = question_marked
                }
                question_number = questions_listed[question_location - 1]
                console.log(question_location - 1);
                console.log(questions_marked[question_location - 1]);
                generate_question(false, questions_marked[question_location - 1])
            } else if (element.id == "finish_button") {
                for (var i in awnser_score) {
                    user_score += awnser_score[i]
                }
                rank_taker(true)
            }
        }
        async function rank_taker(action) {
            if (action) {
                console.log(user_score);
                var rank_taked = await fetch(`http://localhost/phpcodes/quiz_daora_php/rank_arm.php?action=0&user_score=${user_score}`)
                //console.log(rank_taked);
            }
        }
    </script>
</body>

</html>